function do_use()
if(LuaFreeBag()<1)then	LuaShowNotify("请至少保有@21@0格背包空间")	return 0 end
local level=LuaQuery("level")
	if(level>80)then
		level=80
	end
	local r=LuaRandom(100)
	local re=LuaRandom(10)
	local re3=LuaRandom(8)
	LuaSay("如意显灵，宝贝到手！")
	if(r<5)then
		LuaSay("恭喜您！在宝箱里面发现了一个@3金光闪闪@0的@2幸运宝箱@0，这预示着你的@3好@0@5运@0即将到来哦@!")
		LuaGive("o_box002",1,"Tbox001") --幸运宝盒		
	elseif(r<20)then
		LuaSay("恭喜您！获得再来一次的机会，将再奖励一个@2宝箱@0给你哦，这将是你好运的开始哦@!")
		LuaGive("o_box001",1,"Tbox001") --宝盒
	elseif(r<50)then
		local m_exp=30000+(LuaRandom(30)+20)*level^2
		LuaAddJx("combat_exp",m_exp,"Tbox001")
		LuaGive("coin",5000,"Tbox001")
	elseif(r<65)then						
		LuaGive("o_material_"..(15+9*LuaRandom(6)).."",1,"Tbox001")	--5
		LuaNotice("@2"..LuaQueryStr("name").."@0打开@3宝箱@0，得到@25级材料@0一个")
	elseif(r<70)then
		LuaGive("o_material_"..(16+9*LuaRandom(6)).."",1,"Tbox001")	--5
		LuaNotice("@2"..LuaQueryStr("name").."@0打开@3宝箱@0，得到@26级材料@0一个")
	elseif(r<85)then						--道具|10%
		if(re3==0)then
			if(level<30)then
			LuaGive("e_falchion00"..(LuaRandom(floor(level/5))+2).."",1,1,"Tbox001")
			else
			LuaGive("e_falchion01"..(LuaRandom(6)).."",1,1,"Tbox001")-->30
			end
		elseif(re3==1)then
			if(level<30)then
			LuaGive("e_pen00"..(LuaRandom(floor(level/5))+2).."",1,1,"Tbox001")
			elseif(level<50)then
			LuaGive("e_pen01"..(LuaRandom(2)).."",1,1,"Tbox001")
			elseif(level<70)then
			LuaGive("e_pen01"..(LuaRandom(4)).."",1,1,"Tbox001")
			else
			LuaGive("e_pen01"..(LuaRandom(6)).."",1,1,"Tbox001")	
			end
		elseif(re3==2)then
			if(level<30)then
			LuaGive("e_sword00"..(LuaRandom(floor(level/5))+2).."",1,1,"Tbox001")
			else
			LuaGive("e_sword01"..(LuaRandom(6)).."",1,1,"Tbox001")
			end
		elseif(re3==3)then
			ref=LuaRandom(3)
			if(level<43)then
				if(ref==0)then
					LuaGive("e_knife00"..(LuaRandom(floor(level/6))+1).."",1,1,"Tbox001")
				elseif(ref==1)then
					LuaGive("e_book00"..(LuaRandom(floor(level/6))+1).."",1,1,"Tbox001")
				else
					LuaGive("e_shield00"..(LuaRandom(floor(level/6))+1).."",1,1,"Tbox001")
				end
			else
				if(ref==0)then
					LuaGive("e_knife00"..(LuaRandom(7)+1).."",1,1,"Tbox001")
				elseif(ref==1)then
					LuaGive("e_book00"..(LuaRandom(7)+1).."",1,1,"Tbox001")
				else
					LuaGive("e_shield00"..(LuaRandom(7)+1).."",1,1,"Tbox001")
				end
			end
		elseif(re3==4)then
			if(level<30)then
				LuaGive("e_clothes00"..(LuaRandom(7)+2).."",1,1,"Tbox001")
			else
				LuaGive("e_clothes01"..(LuaRandom(8)).."",1,1,"Tbox001")
			end
		elseif(re3==5)then
			if(level<30)then
			LuaGive("e_pants00"..(LuaRandom(floor(level/4))+2).."",1,1,"Tbox001")
			else
			LuaGive("e_pants01"..(LuaRandom(8)).."",1,1,"Tbox001")
			end
		elseif(re3==6)then
			local res=LuaRandom(2)
			if(level<40)then
			        if(res==0)then
				LuaGive("e_necklace00"..(LuaRandom(floor(level/6))+1).."",1,1,"Tbox001")
				else
				LuaGive("e_earring00"..(LuaRandom(floor(level/6))+1).."",1,1,"Tbox001")
				end
			else
				if(res==0)then
				LuaGive("e_necklace00"..(LuaRandom(8)+1).."",1,1,"Tbox001")
				else
				LuaGive("e_earring00"..(LuaRandom(8)+1).."",1,1,"Tbox001")
				end
			end
		elseif(re3==7)then
			if(level<30)then
			LuaGive("e_shoes00"..(LuaRandom(floor(level/6))+1).."",1,1,"Tbox001")
			else
			LuaGive("e_shoes00"..(LuaRandom(6)+3).."",1,1,"Tbox001")
			end
		end
	elseif(r<95)then --10%
		local num=5+LuaRandom(6)
		LuaGive("o_longyu",num,"Tbox001")
		LuaNotice("@2"..LuaQueryStr("name").."@0打开@3宝箱@0，发现了一大堆@2龙玉@0")

	elseif(r<98)then --3%
		if(re3==0)then
			if(level<30)then
			LuaGive("e_falchion00"..(LuaRandom(floor(level/5))+2).."",1,2,"Tbox001")
			else
			LuaGive("e_falchion01"..(LuaRandom(6)).."",1,2,"Tbox001")-->30
			end
		elseif(re3==1)then
			if(level<30)then
			LuaGive("e_pen00"..(LuaRandom(floor(level/5))+2).."",1,2,"Tbox001")
			elseif(level<50)then
			LuaGive("e_pen01"..(LuaRandom(2)).."",1,2,"Tbox001")
			elseif(level<70)then
			LuaGive("e_pen01"..(LuaRandom(4)).."",1,2,"Tbox001")
			else
			LuaGive("e_pen01"..(LuaRandom(6)).."",1,2,"Tbox001")	
			end
		elseif(re3==2)then
			if(level<30)then
			LuaGive("e_sword00"..(LuaRandom(floor(level/5))+2).."",1,2,"Tbox001")
			else
			LuaGive("e_sword01"..(LuaRandom(6)).."",1,2,"Tbox001")
			end
		elseif(re3==3)then
			ref=LuaRandom(3)
			if(level<43)then
				if(ref==0)then
					LuaGive("e_knife00"..(LuaRandom(floor(level/6))+1).."",1,2,"Tbox001")
				elseif(ref==1)then
					LuaGive("e_book00"..(LuaRandom(floor(level/6))+1).."",1,2,"Tbox001")
				else
					LuaGive("e_shield00"..(LuaRandom(floor(level/6))+1).."",1,2,"Tbox001")
				end
			else
				if(ref==0)then
					LuaGive("e_knife00"..(LuaRandom(7)+1).."",1,2,"Tbox001")
				elseif(ref==1)then
					LuaGive("e_book00"..(LuaRandom(7)+1).."",1,2,"Tbox001")
				else
					LuaGive("e_shield00"..(LuaRandom(7)+1).."",1,2,"Tbox001")
				end
			end
		elseif(re3==4)then
			if(level<30)then
				LuaGive("e_clothes00"..(LuaRandom(7)+2).."",1,2,"Tbox001")
			else
				LuaGive("e_clothes01"..(LuaRandom(8)).."",1,2,"Tbox001")
			end
		elseif(re3==5)then
			if(level<30)then
			LuaGive("e_pants00"..(LuaRandom(floor(level/4))+2).."",1,2,"Tbox001")
			else
			LuaGive("e_pants01"..(LuaRandom(8)).."",1,2,"Tbox001")
			end
		elseif(re3==6)then
			res=LuaRandom(2)
			if(level<40)then
			        if(res==0)then
				LuaGive("e_necklace00"..(LuaRandom(floor(level/6))+1).."",1,2,"Tbox001")
				else
				LuaGive("e_earring00"..(LuaRandom(floor(level/6))+1).."",1,2,"Tbox001")
				end
			else
				if(res==0)then
				LuaGive("e_necklace00"..(LuaRandom(8)+1).."",1,2,"Tbox001")
				else
				LuaGive("e_earring00"..(LuaRandom(8)+1).."",1,2,"Tbox001")
				end
			end
		elseif(re3==7)then
			if(level<30)then
			LuaGive("e_shoes00"..(LuaRandom(floor(level/6))+1).."",1,2,"Tbox001")
			else
			LuaGive("e_shoes00"..(LuaRandom(6)+3).."",1,2,"Tbox001")
			end
		end
	elseif(r==98)then--金1%
			if(re3==0)then
				if(level<30)then
				LuaGive("e_falchion00"..(LuaRandom(floor(level/5))+2).."",1,3,"Tbox001")--<30
				else
				LuaGive("e_falchion01"..(LuaRandom(6)).."",1,3,"Tbox001")-->30
				end
			elseif(re3==1)then
				if(level<30)then
				LuaGive("e_pen00"..(LuaRandom(floor(level/5))+2).."",1,3,"Tbox001")
				elseif(level<50)then
				LuaGive("e_pen01"..(LuaRandom(2)).."",1,3,"Tbox001")
				elseif(level<70)then
				LuaGive("e_pen01"..(LuaRandom(4)).."",1,3,"Tbox001")
				else
				LuaGive("e_pen01"..(LuaRandom(6)).."",1,3,"Tbox001")	
				end
			elseif(re3==2)then
				if(level<30)then
				LuaGive("e_sword00"..(LuaRandom(floor(level/5))+2).."",1,3,"Tbox001")
				else
				LuaGive("e_sword01"..(LuaRandom(6)).."",1,3,"Tbox001")
				end
			elseif(re3==3)then
				ref=LuaRandom(3)
				if(level<43)then
					if(ref==0)then
						LuaGive("e_knife00"..(LuaRandom(floor(level/6))+1).."",1,3,"Tbox001")
					elseif(ref==1)then
						LuaGive("e_book00"..(LuaRandom(floor(level/6))+1).."",1,3,"Tbox001")
					else
						LuaGive("e_shield00"..(LuaRandom(floor(level/6))+1).."",1,3,"Tbox001")
					end
				else
					if(ref==0)then
						LuaGive("e_knife00"..(LuaRandom(7)+1).."",1,3,"Tbox001")
					elseif(ref==1)then
						LuaGive("e_book00"..(LuaRandom(7)+1).."",1,3,"Tbox001")
					else
						LuaGive("e_shield00"..(LuaRandom(7)+1).."",1,3,"Tbox001")
					end
				end
			elseif(re3==4)then
				if(level<30)then
					LuaGive("e_clothes00"..(LuaRandom(7)+2).."",1,3,"Tbox001")
				else
					LuaGive("e_clothes01"..(LuaRandom(8)).."",1,3,"Tbox001")
				end
			elseif(re3==5)then
				if(level<30)then
				LuaGive("e_pants00"..(LuaRandom(floor(level/4))+2).."",1,3,"Tbox001")
				else
				LuaGive("e_pants01"..(LuaRandom(8)).."",1,3,"Tbox001")
				end
			elseif(re3==6)then
				res=LuaRandom(2)
				if(level<40)then
					if(res==0)then
					LuaGive("e_necklace00"..(LuaRandom(floor(level/6))+1).."",1,3,"Tbox001")
					else
					LuaGive("e_earring00"..(LuaRandom(floor(level/6))+1).."",1,3,"Tbox001")
					end
				else
					if(res==0)then
					LuaGive("e_necklace00"..(LuaRandom(8)+1).."",1,3,"Tbox001")
					else
					LuaGive("e_earring00"..(LuaRandom(8)+1).."",1,3,"Tbox001")
					end
				end
			elseif(re3==7)then
				if(level<30)then
				LuaGive("e_shoes00"..(LuaRandom(floor(level/6))+1).."",1,3,"Tbox001")
				else
				LuaGive("e_shoes00"..(LuaRandom(6)+3).."",1,3,"Tbox001")
				end
			end
			LuaNotice("@2"..LuaQueryStr("name").."@0打开@3宝箱@0，得到一件@5金色装备")
		elseif(r==99)then
			if(LuaQueryStr("class")=="shen") then      --战士
				if(LuaRandom(2)==0)then
					LuaGive("e_falchionT5",1,3,"Tbox001")
				else
					LuaGive("e_falchionT6",1,3,"Tbox001")
				end
					
			elseif(LuaQueryStr("class")=="wu") then       --侠客
				if(LuaRandom(2)==0)then
					LuaGive("e_swordT3",1,3,"Tbox001")
				else
					LuaGive("e_swordT4",1,3,"Tbox001")
				end
			elseif(LuaQueryStr("class")=="xian") then       --谋士
				if(LuaRandom(2)==0)then
					LuaGive("e_penT7",1,3,"Tbox001")
				else
					LuaGive("e_fanT8",1,3,"Tbox001")
				end
			end	
			LuaSay("恭喜您！获得传说中的@3黄金变态武器@0")
			LuaNotice("@2"..LuaQueryStr("name").."@0打开@3宝箱@0，得到一件@33小时时限且必然掉落@0的@5金色超级装备!@0")
		end
		

LuaOtherSendMenu()
return 1
end